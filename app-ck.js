/*
*  MAIN APPLICATION
***************************************************************** */var express=require("express"),http=require("http"),cons=require("consolidate"),swig=require("swig"),path=require("path");app=express(),app.configure(function(){app.set("port",process.env.PORT||3e3),swig.init({root:__dirname,allowErrors:!0}),app.set("views",__dirname),app.engine(".html",cons.swig),app.set("view engine","html"),app.use(express.favicon()),app.use(express.logger("dev")),app.use(express.bodyParser()),app.use(express.methodOverride()),app.use(express.cookieParser("my secret here")),app.use(express.session()),app.use(app.router),app._=require("underscore")}),app.configure("development",function(){app.use(express.errorHandler())});var debug=!0;l=function(e,t){app._.isUndefined(e)&&(e=""),app._.isUndefined(t)&&(t=""),debug&&console.log(e,t)},app.getExtension=function(e){var t=e.lastIndexOf(".");return t<0?"":e.substr(t)},e=require("./EventBus/EventBus.js"),e.doit(),app.locals={appDir:__dirname,basePath:"/",title:"Home",error:!1,styles:[]},app.locals.routes=[{slug:["/"],name:"WELCOME"},{slug:["/chat"],name:"CHAT"},{slug:["/about"],name:"ABOUT"},{slug:["/contact"],name:"CONTACT"}];var t=require("./helper/KissForm");t.newForm("registerUser"),t.addFormItem("eMail","email","email"),t.addFormItem("Password","password","password"),app.locals.registerUserForm=t.getForm(),app.use("/layout/assets",express.static(__dirname+"/layout/assets")),app.use("/layout/css",express.static(__dirname+"/layout/css")),app.use("/layout/js",express.static(__dirname+"/layout/js")),require("./layout/css"),db=null,userModel=null,require("./database/Database.js")("SWIG",function(e){db=e,db.collection("user",function(e,t){userModel=require("./database/UserModel.js"),userModel.getAll(function(e){})})});var server=http.createServer(app).listen(app.get("port"),function(){console.log("Express server listening on port "+app.get("port")),app.io=require("./socket/socket.js")(server),require("./components")});